#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\input colordvi
\usepackage{color}
\fancyhead{}
\fancyfoot[CE,CO]{}
\newtoks{\addressee} \global\addressee={}
\newdimen\longindent \longindent=3.5truein
\fancyhead[L]{Memo to: \the\addressee \\ \datetoday \\ Page \thepage \hfill}
\renewcommand{\headrulewidth}{0.0pt}
\newenvironment{lyxlist}[1]
{\begin{list}{}
{\settowidth{\labelwidth}{#1}
\setlength{\leftmargin}{\labelwidth}
\addtolength{\leftmargin}{\labelsep}
\renewcommand{\makelabel}[1]{##1\hfil}}}
{\end{list}}
\newcommand{\datetoday}{\number\day\space
     \ifcase\month\or January\or February\or March\or April\or May\or
     June\or July\or August\or September\or October\or November\or
     December\fi
     \space\number\year}
\newcommand{\EOLmemo}{\null \vskip-1.5truein
{\raggedright \textsf{\textsc{\large \textcolor{blue}{Earth Observing Laboratory}}}}\par
{\raggedright \textsf{\textsl{\textcolor{blue}{Memorandum:}}}} \par \vskip6pt
{\color{blue}{\hrule}}\par
\vskip0.3truein \leftline{\hskip \longindent \datetoday} \vskip0.2truein
\thispagestyle{empty}}
\newcommand{\attachm}[1]{\begin{lyxlist}{Attachments:00}
\item [Attachments:] {#1}
\end{lyxlist}}
\newcommand{\cc}[1]{\begin{lyxlist}{Attachments:00}
\item [cc:] {#1}
\end{lyxlist}}
\newcommand{\attach}[1]{\begin{lyxlist}{Attachments:00}
\item [Attachment:] {#1}
\end{lyxlist}}
%usage: \encl{A\\B\\C} or \cc{ma,e1\\name2\\name3}
\end_preamble
\use_default_options false
\begin_modules
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding default
\fontencoding global
\font_roman "times" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref false
\papersize letterpaper
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 0
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 0
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2.54cm
\topmargin 3.54cm
\rightmargin 2.54cm
\bottommargin 2.54cm
\headheight 1cm
\headsep 2cm
\footskip 0.5cm
\secnumdepth 2
\tocdepth 2
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
To:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
the
\backslash
addressee
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
From:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Al Cooper
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Subject:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Studies of the measurements of wind using LAMS
\begin_inset Note Note
status open

\begin_layout Plain Layout
XXX or comments flag changes needing attention
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
bigskip
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<initialization,echo=FALSE,include=FALSE>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

library(knitr)
\end_layout

\begin_layout Plain Layout

opts_chunk$set(echo=FALSE, include=FALSE, fig.lp="fig:")
\end_layout

\begin_layout Plain Layout

opts_chunk$set(fig.width=6, fig.height=5, fig.pos="center", digits=4)
\end_layout

\begin_layout Plain Layout

thisFileName <- "ARISTO2015-LAMS"
\end_layout

\begin_layout Plain Layout

require(Ranadu, quietly = TRUE, warn.conflicts=FALSE)
\end_layout

\begin_layout Plain Layout

require(ggplot2)
\end_layout

\begin_layout Plain Layout

require(grid)
\end_layout

\begin_layout Plain Layout

require(ggthemes)
\end_layout

\begin_layout Plain Layout

Directory <- DataDirectory ()
\end_layout

\begin_layout Plain Layout

Flight <- "rf03_LAMS" 				# XXX change this
\end_layout

\begin_layout Plain Layout

Project = "ARISTO"	
\end_layout

\begin_layout Plain Layout

ProjectDir <- "ARISTO"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

VarList <- c("WDC", "WSC", "WIC", "AKRD", "SSRD", "U_LAMS", "V_LAMS", "W_LAMS",
\end_layout

\begin_layout Plain Layout

             "Beam1_LAMS", "Beam2_LAMS", "Beam3_LAMS", "Beam4_LAMS",  ##
 Scott's values
\end_layout

\begin_layout Plain Layout

             "BEAM1speed", "BEAM2speed", "BEAM3speed", "BEAM4speed", "ADIFR",
 "QCF", "BDIFR",
\end_layout

\begin_layout Plain Layout

             "CVEW_LAMS", "CVNS_LAMS", "CVSPD_LAMS", "GGVEW", "GGVNS",
\end_layout

\begin_layout Plain Layout

             "CTHDG_LAMS", "CROLL_LAMS", "CPITCH_LAMS", "PITCH", "ROLL",
 "THDG",
\end_layout

\begin_layout Plain Layout

             "WD_LAMS", "WS_LAMS", "WI_LAMS", "ATTACK_L", "SSLIP_L", "TASX")
\end_layout

\begin_layout Plain Layout

VarList <- c(VarList, 'PSFD', 'QCF', 'ADIFR', 'GGVSPD', 'EWX')
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

PCA <- FALSE
\end_layout

\begin_layout Plain Layout

PCA <- TRUE  ## if set true, will use Spuler's PCA-algorithm beam speeds		
\end_layout

\begin_layout Plain Layout

SaveRData <- sprintf("%s.Rdata.gz", thisFileName)
\end_layout

\begin_layout Plain Layout

SummarizeFit <- function(ft) {
\end_layout

\begin_layout Plain Layout

  print (summary(ft)$call)
\end_layout

\begin_layout Plain Layout

  print ("Coefficients:")
\end_layout

\begin_layout Plain Layout

  print (summary(ft)$coefficients)
\end_layout

\begin_layout Plain Layout

  print (sprintf ("Residual standard deviation: %.3f, dof=%d", summary(ft)$sigma,
 summary(ft)$df[2]))
\end_layout

\begin_layout Plain Layout

  print (sprintf ("R-squared %.3f", summary(ft)$r.squared))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
During the 2015 ARISTO project on the C-130, the LAMS was flown in a 4-beam
 configuration.
 The beam assignments were non-standard, though, with beam 2 forward, beam
 1 downward, beam 3 outboard and upward, and beam 4 inboard and upward.
 Beams 1, 3 and 4 were approximately 35
\begin_inset Formula $^{\circ}$
\end_inset

 from the forward direction, and relative to an azimuthal angle starting
 from the downward direction they were, respectively, 0, 
\begin_inset Formula $-120$
\end_inset

 and 120
\begin_inset Formula $^{\circ}$
\end_inset

 in clockwise rotation about the forward longitudinal axis.
 
\end_layout

\begin_layout Standard
There were five research flights.
 All had some degree of measurement problems, so data for this study have
 been selected from the periods that appear to provide the best measurements.
 The following table provides a few of the characteristics of these flights:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="5cm">
<column alignment="center" valignment="top" width="5cm">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
date
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
end
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
profile
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
problems
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150916
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
160225
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200605
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
climb->20kft, level, stepped descent to BL, no maneuvers
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS IRU attitude angles bad
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150923
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
135907
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
204016
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mostly low level until near end; LAMS reasonable, although weak; some speed
 variations
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
actual takeoff about 170000; BEAM2speed weak, BEAM2_LAMS (Scott's value)
 better.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150925
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
162500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
214500
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
both upper and lower-level legs; speed runs, pitch maneuvers, some turbulence
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CPITCH_LAMS bad before 192300, and CROLL also, so wind measurements from
 LAMS unavailable until after then.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
150930
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
170100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
205000
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
good pitch and yaw maneuvers; also a partial speed run.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Beams 1 and 4 problematic before 1915 in high-level leg; beam 2 probably
 useful for TAS.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
151002
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
143000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
184400
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
upper-level pitches and lower-level turbulence
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS beam peaks look very weak to me, questionable although SMS processing
 seems reasonable.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The line-of-sight beam speeds were determined in two ways.
 Scott Spuler used principal-component analysis to find the beam speeds,
 and usually this worked very well, although there are some suspicious times.
 For example, the peaks in Flight 5 look very weak, yet the PCA method continued
 to find output values.
 Because there was tight coupling to the expected measured TAS (with adjustment
 for the beam angles), it appears suspicious that the method may be duplicating
 the TAS value at times without having an adequate signal.
 The match to TASX looks so good that it seems suspicious, as discussed
 later.
 A second method was to fit the background using Savitzgy-Golay polynomials
 and then search for peaks above this background.
 When signals were strong, the method usually produced the same result as
 the PCA method, but it was more prone to failure during periods where the
 signal was weak.
 (A signal-to-noise test of 
\begin_inset Formula $\geq4$
\end_inset

 was required for a valid measurement.) Results from both these peak-detecting
 algorithms will be discussed in this memo.
\end_layout

\begin_layout Standard
There are several objectives that can be met by using the LAMS-derived measureme
nts:
\end_layout

\begin_layout Enumerate
The LAMS provides an independent measurement of angle-of-attack and sideslip
 angle, so these measurements can be used to check the empirical relationships
 used to calibrate the radome-based measurements of these angles.
\end_layout

\begin_layout Enumerate
LAMS provides an independent measurement of the airspeed, so from that measureme
nt it is possible to determine the expected dynamic pressure.
 This was used previously(Cooper et al., 2014) to calibrate not only the
 dynamic pressure but also the static pressure as measured on the C-130.
 However, since then the offset between the avionic static pressure and
 the research static pressure calibrated in this way has changed, so it
 is important to learn if the static defect actually changed or perhaps
 the avionic value changed.
 This has an important effect on the longitudinal component of the measured
 wind as well.
\end_layout

\begin_layout Enumerate
The paper by Cooper et al.
\begin_inset space ~
\end_inset

(2014) developed a method for measuring temperature using the LAMS, which
 might have potential to provide a valid measurement of temperature in clouds.
 However, only a small sample of measurements were available, so it will
 be useful to explore if further measurements from ARISTO-2015 help characterize
 this measurement.
\end_layout

\begin_layout Enumerate
The method used to calibrate the radome is based primarily on slowly varying
 measurements, such as the variation in angle-of-attack during a speed run.
 It is of concern that the calibration used might not apply in the case
 of rapidly changing flight conditions, when for example there might be
 transient adjustment of the airflow pattern toward a new steady state.
 Because the LAMS measures wind well ahead of the aircraft, such effects
 should not appear in the LAMS-based measurements, so a comparison of the
 LAMS-based and radome-based measurements might either identify transient-respon
se problems or place limits on how large such effects might be.
\end_layout

\begin_layout Section*
Data processing
\end_layout

\begin_layout Standard
The original netCDF files, with names like ARISTOrf01.nc, contain histograms
 of the LAMS frequency measurements, with names like BEAM{1–4}_LAMS.
 Scott Spuler has processed these to produce files like ARISTOrf01_LAMS.nc
 with new variables Beam{1–4}_LAMS containing the line-of-sight speeds measured
 in each beam.
 In addition, the Python program LAMS_ARISTO.py has been used to process
 these further to files ARISTOrfxx_LAMSLAMS.nc, which contain additional
 variables BEAM{1–4}speed also representing the line-of-sight speeds.
 Both sets of variables, Beam{1–4}_LAMS and BEAM{1–4}speed, will be used,
 but they appear to have different strengths:
\end_layout

\begin_layout Enumerate
The variables Beam{1–4}_LAMS are produced by Spuler's PCA routine.
 This is the most sensitive detection method, but there is some suspicion
 that it produces values when there is inadequate signal, perhaps by too
 much reliance on TASX to determine where the peak should be.
 
\end_layout

\begin_layout Enumerate
The variables BEAM{1–4}speed are produced by smoothing the histograms with
 Savitzgy-Golay polynomials and then searching for peaks above the smoothed
 background.
 This algorithm also uses TASX to determine likely locations for the peaks,
 but with a fairly large tolerance, and it requires a signal-to-noise ratio
 
\begin_inset Formula $\geq4$
\end_inset

 or else it produces a missing-value result.
 In ARISTO2015, this algorithm was significantly less sensitive than the
 PCA algorithm, and for example in Flight 5 it mostly did not produce useful
 results while the PCA algorithm produced almost continuous results for
 the line-of-sight beam speeds.
\end_layout

\begin_layout Standard
The Python routine also produced new variables named WD_LAMS, WS_LAMS, WI_LAMS,
 ATTACK_L and SSLIP_L, using the processing algorithms for a 4-beam LAMS
 that were discussed in the documents LAMSprocessing4Bwind.pdf and LAMSprocessing
3Dwind.pdf.
 These variables were also used in the present R routine (this file) to
 generate measurements of vertical and horizontal wind, airspeed, and angles
 of attack and sideslip.
 For airspeed, angle of attack, and sideslip, these steps were used:
\end_layout

\begin_layout Enumerate
The four-beam measurements were used to determine a three-dimensional relative
 wind vector 
\series bold
RW
\series default
={
\begin_inset Formula $\mathrm{RW}_{x},\,\mathrm{RW}_{y},\,\mathrm{RW_{z}}$
\end_inset

}
\series bold
 
\series default
with components inbound along the longitudinal forward, lateral starboard,
 and lateral downward axis in the coordinate frame of the LAMS IRU (with
 attitude angles CPITCH, CROLL, CTHDG).
 The algorithm is documented in LAMSprocessing4Bwind.pdf.
 
\end_layout

\begin_layout Enumerate
The airspeed is then the magnitude of the vector 
\series bold
RW
\series default
.
\end_layout

\begin_layout Enumerate
The angle of attack is 
\begin_inset Formula $\alpha=\arctan\left(\mathrm{RW}_{z}/\mathrm{RW}_{x}\right)$
\end_inset

 and the sideslip angle is 
\begin_inset Formula $\beta=\arctan\left(\mathrm{RW}_{y}/\mathrm{RW}_{x}\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<beam-processing, echo=FALSE, include=TRUE, fig.cap='Wind measurements:
 conventional (blue), PCA-based (green), SG-based (red).
 The time period is restricted to 19:23--21:30 UTC because the LAMS IRU
 produced erronous values for the attitude angles at other times.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

processWind <- function(Data) {
\end_layout

\begin_layout Plain Layout

  Data$BEAM1speed <- zoo::na.approx (as.vector(Data$BEAM1speed), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  Data$BEAM2speed <- zoo::na.approx (as.vector(Data$BEAM2speed), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  Data$BEAM3speed <- zoo::na.approx (as.vector(Data$BEAM3speed), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  Data$BEAM4speed <- zoo::na.approx (as.vector(Data$BEAM4speed), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  ## replace with Scott's values
\end_layout

\begin_layout Plain Layout

  if (PCA) {
\end_layout

\begin_layout Plain Layout

    Data$BEAM1speed <- zoo::na.approx (as.vector(Data$Beam1_LAMS), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

    Data$BEAM2speed <- zoo::na.approx (as.vector(Data$Beam2_LAMS), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

    Data$BEAM3speed <- zoo::na.approx (as.vector(Data$Beam3_LAMS), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

    Data$BEAM4speed <- zoo::na.approx (as.vector(Data$Beam4_LAMS), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  ## try to fix CTHDG_LAMS bad points in transition through 180: (may no
 longer be needed)
\end_layout

\begin_layout Plain Layout

  for (i in 2:(nrow(Data)-1)) {
\end_layout

\begin_layout Plain Layout

    if (is.na(Data$CTHDG_LAMS[i]) || is.na(Data$CTHDG_LAMS[i-1]) || is.na(Data$CTHD
G_LAMS[i+1])) {next}
\end_layout

\begin_layout Plain Layout

    if (abs(Data$CTHDG[i-1]-Data$CTHDG_LAMS[i+1]) > 10.) {next}
\end_layout

\begin_layout Plain Layout

    if ((Data$CTHDG_LAMS[i-1] < 180.) && (Data$CTHDG_LAMS[i+1] > 180)) {Data$CTHD
G_LAMS[i] <- NA}
\end_layout

\begin_layout Plain Layout

    if ((Data$CTHDG_LAMS[i-1] > 180.) && (Data$CTHDG_LAMS[i+1] < 180)) {Data$CTHD
G_LAMS[i] <- NA}
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

  Data$CTHDG_LAMS <- zoo::na.approx (as.vector(Data$CTHDG_LAMS), maxgap=1000,
 na.rm = FALSE)
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  Theta =  c(35.0802, 34.8501, 34.8496, 0.) * pi / 180 # revised 12 May 2014
\end_layout

\begin_layout Plain Layout

  Theta <- c(35, 0, 35, 35) * pi / 180  ## ARISTO
\end_layout

\begin_layout Plain Layout

  Phi = c(179.2171, -61.0712, 59.1506, 0.) * pi / 180  #  "  "
\end_layout

\begin_layout Plain Layout

  Phi = c(0, 0, -120, 120) * pi / 180
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  # also need the distances from the IRS to LAMS: (x,y,z)
\end_layout

\begin_layout Plain Layout

  LL = c(-10.305, -6.319, 1.359)                # these are GV values; need
 C130 values
\end_layout

\begin_layout Plain Layout

  # unit vectors along beams are then:
\end_layout

\begin_layout Plain Layout

  #   a[i] = [cos(Theta[i]), -sin(Theta[i])*sin(Phi[i]), sin(Theta[i])*cos(Phi[i
])]
\end_layout

\begin_layout Plain Layout

  # and the dot products with the (i,j,k) unit vectors give the direction
 cosine matrix:
\end_layout

\begin_layout Plain Layout

  S = c(cos(Theta[1]), -sin(Theta[1])*sin(Phi[1]), sin(Theta[1])*cos(Phi[1]),
 
\end_layout

\begin_layout Plain Layout

                 cos(Theta[2]), -sin(Theta[2])*sin(Phi[2]), sin(Theta[2])*cos(Ph
i[2]), 
\end_layout

\begin_layout Plain Layout

                 cos(Theta[3]), -sin(Theta[3])*sin(Phi[3]), sin(Theta[3])*cos(Ph
i[3]))
\end_layout

\begin_layout Plain Layout

  S4 <- c(S, cos(Theta[4]), -sin(Theta[4])*sin(Phi[4]), sin(Theta[4])*cos(Phi[4]
))
\end_layout

\begin_layout Plain Layout

  dim(S) <- c(3,3)
\end_layout

\begin_layout Plain Layout

  Si = t(solve(S))  # calculate the inverse of S -- this is the 3-beam version
\end_layout

\begin_layout Plain Layout

  ## the following commented lines are the python code:
\end_layout

\begin_layout Plain Layout

  # S4 = np.vstack ((S, [cos(Theta[3]), -sin(Theta[3])*sin(Phi[3]), sin(Theta[3])
*cos(Phi[3])]))
\end_layout

\begin_layout Plain Layout

  # StS =  linalg.inv (ma.dot (S4.T, S4))
\end_layout

\begin_layout Plain Layout

  # M = ma.dot (StS, S4.T)      # matrix for finding relative wind from 4-beam
 LAMS
\end_layout

\begin_layout Plain Layout

  dim(S4) <- c(3,4)
\end_layout

\begin_layout Plain Layout

  StS <- S4 %*% t(S4)
\end_layout

\begin_layout Plain Layout

  StS <- solve(StS)
\end_layout

\begin_layout Plain Layout

  M <- StS %*% S4
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  A = c(Data$BEAM1speed, Data$BEAM2speed, Data$BEAM3speed)
\end_layout

\begin_layout Plain Layout

  A4 <- c(A, Data$BEAM4speed)
\end_layout

\begin_layout Plain Layout

  dim(A4) <- c(nrow(Data), 4)
\end_layout

\begin_layout Plain Layout

  dim(A) <- c(nrow(Data), 3)
\end_layout

\begin_layout Plain Layout

  RW = t (Si %*% t(A))    # gives u, v, w components, RW[,1] is u
\end_layout

\begin_layout Plain Layout

  RW2 <- t (M %*% t(A4))
\end_layout

\begin_layout Plain Layout

  RW <- RW2
\end_layout

\begin_layout Plain Layout

  ## calculate the error in the solution:
\end_layout

\begin_layout Plain Layout

  A4P <- t (t (S4) %*% t (RW2)) - A4
\end_layout

\begin_layout Plain Layout

  CSQ <- A4P[,1]^2 + A4P[,2]^2 + A4P[,3]^2 + A4P[,4]^2
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  ## set up special data.frame for calculation of wind:
\end_layout

\begin_layout Plain Layout

  D <- data.frame("Time"=Data$Time)
\end_layout

\begin_layout Plain Layout

  D$TASX <- sqrt(RW[,1]^2 + RW[,2]^2 + RW[,3]^2)
\end_layout

\begin_layout Plain Layout

  D$TASCSQ <- CSQ 
\end_layout

\begin_layout Plain Layout

  D$ATTACK <- atan (RW[, 3] / RW[, 1]) * 180 / pi
\end_layout

\begin_layout Plain Layout

  D$SSLIP <-  atan (RW[, 2] / RW[, 1]) * 180 / pi
\end_layout

\begin_layout Plain Layout

  D$GGVEW <- Data$CVEW_LAMS
\end_layout

\begin_layout Plain Layout

  D$GGVNS <- Data$CVNS_LAMS
\end_layout

\begin_layout Plain Layout

  D$GGVSPD <- Data$CVSPD_LAMS
\end_layout

\begin_layout Plain Layout

  D$VEW <- Data$CVEW_LAMS
\end_layout

\begin_layout Plain Layout

  D$VNS <- Data$CVNS_LAMS
\end_layout

\begin_layout Plain Layout

  D$THDG <- Data$CTHDG_LAMS
\end_layout

\begin_layout Plain Layout

  D$ROLL <- Data$CROLL_LAMS
\end_layout

\begin_layout Plain Layout

  D$PITCH <- Data$CPITCH_LAMS
\end_layout

\begin_layout Plain Layout

  ## save some variables for ease of plotting:
\end_layout

\begin_layout Plain Layout

  D$BEAM1speed <- Data$BEAM1speed
\end_layout

\begin_layout Plain Layout

  D$BEAM2speed <- Data$BEAM2speed
\end_layout

\begin_layout Plain Layout

  D$BEAM3speed <- Data$BEAM3speed
\end_layout

\begin_layout Plain Layout

  D$BEAM4speed <- Data$BEAM4speed
\end_layout

\begin_layout Plain Layout

  D$WDC <- Data$WDC
\end_layout

\begin_layout Plain Layout

  D$WSC <- Data$WSC
\end_layout

\begin_layout Plain Layout

  D$WIC <- Data$WIC
\end_layout

\begin_layout Plain Layout

  D$WD_LAMS <- Data$WD_LAMS
\end_layout

\begin_layout Plain Layout

  D$WS_LAMS <- Data$WS_LAMS
\end_layout

\begin_layout Plain Layout

  D$WI_LAMS <- Data$WI_LAMS
\end_layout

\begin_layout Plain Layout

  D$AKRD <- Data$AKRD
\end_layout

\begin_layout Plain Layout

  D$SSRD <- Data$SSRD
\end_layout

\begin_layout Plain Layout

  D$ADIFR <- Data$ADIFR
\end_layout

\begin_layout Plain Layout

  D$QCF <- Data$QCF
\end_layout

\begin_layout Plain Layout

  D$GGVSPD <- Data$GGVSPD
\end_layout

\begin_layout Plain Layout

  D$PSFD <- Data$PSFD
\end_layout

\begin_layout Plain Layout

  D$EWX <- Data$EWX
\end_layout

\begin_layout Plain Layout

  # if (grepl('rf03', fname)) {
\end_layout

\begin_layout Plain Layout

  #   rg <- setRange (D$Time, 192300,213000)
\end_layout

\begin_layout Plain Layout

  #   D <- D[rg, ]
\end_layout

\begin_layout Plain Layout

  # }
\end_layout

\begin_layout Plain Layout

  ## use standard wind processor 
\end_layout

\begin_layout Plain Layout

  ### rotation-rate corrections should be removed first, 
\end_layout

\begin_layout Plain Layout

  ### but for standard routine they are insignificant so will be ignored.
\end_layout

\begin_layout Plain Layout

  DW <- WindProcessor (data=D)
\end_layout

\begin_layout Plain Layout

  return (DW)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

DW <- processWind (Data)
\end_layout

\begin_layout Plain Layout

rg <- setRange (DW, 192300, 213000)
\end_layout

\begin_layout Plain Layout

DW <- DW[rg,]  ## select time when LAMS IRU was working
\end_layout

\begin_layout Plain Layout

layout(matrix(1:3, ncol = 1), widths = 1,  heights = c(5,5,6))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(2,4,1,1)+0.1, oma=c(1.1,0,0,0))
\end_layout

\begin_layout Plain Layout

plotWAC(DW[c("Time", "WDC", "WDN", 'WD_LAMS')])  #, ylim=c(250,360))
\end_layout

\begin_layout Plain Layout

title(fname)
\end_layout

\begin_layout Plain Layout

plotWAC(DW[c("Time", "WSC", "WSN", 'WS_LAMS')], ylim=c(0,40))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(5,4,1,1)+0.1)
\end_layout

\begin_layout Plain Layout

plotWAC(DW[c("Time", "WIC", "WIN", 'WI_LAMS')], ylim=c(-5,5))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results for the various processing schemes are shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:beam-processing}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
clearpage
\end_layout

\end_inset


\end_layout

\begin_layout Section*
Sensitivity coefficients
\end_layout

\begin_layout Subsection*
Angle of attack
\end_layout

\begin_layout Standard
The following speed-run maneuvers are available from ARISTO2015:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
#
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
flight
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
end
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
comments
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
183200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
185500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PCA, not SG
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
193800
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PCA or (SG exc 193000)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
171300
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
173800
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CPITCH bad
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
183400
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
185700
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CPITCH bad
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
205500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
210000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
slowdown only; PCA only
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
174300
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
180700
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PCA only
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
191200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
193000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PCA only; SG weak
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
202500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
203900
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PCA; SG B1 weak
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The values of vertical wind as originally processed did not look very good,
 so the first step was to determine a conventional set of sensitivity coefficien
ts to use as a radome calibration.
 For this purpose, a data.frame consisting of a concatenation of the eight
 speed runs in the preceding table was constructed and a reference value
 for calibration (AOAREF) was added to the data.frame.
 AOAREF, defined below, is the value that should be measured for angle of
 attack if the true vertical wind is zero during the maneuver:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\mathrm{AOAREF}=\theta+\frac{w_{p}}{V}\frac{180}{\pi}
\]

\end_inset

where 
\begin_inset Formula $\theta$
\end_inset

 is the pitch angle (variable PITCH), 
\begin_inset Formula $w_{p}$
\end_inset

 is the rate of climb of the aircraft (variable GGVSPD), and 
\begin_inset Formula $V$
\end_inset

 is the true airspeed (variable TASX).
 The conventional fit is then
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\mathrm{AOAREF}=c_{0}+\frac{\mathrm{ADIFR}}{\mathrm{QCF}}\left(c_{1}+c_{2}\thinspace\mathrm{MACH}\right)
\]

\end_inset

where 
\begin_inset Formula $\mathrm{MACH}$
\end_inset

 is the Mach number determined from the uncorrected measurements PSFD and
 QCF (cf.
\begin_inset space ~
\end_inset

the technical note on processing algorithms).
 In addition, a data.frame consisting of all measurements from flights 2–4
 was constructed and coefficients were also determined for a fit to those
 data.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<All-flight-cal, include=TRUE, fig.cap=''>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Data <- getNetCDF('/Data/ARISTO/ARISTOrf02_LAMSLAMS.nc', VarList, F=2)
\end_layout

\begin_layout Plain Layout

Data <- rbind(Data, getNetCDF('/Data/ARISTO/ARISTOrf03_LAMSLAMS.nc', VarList,
 F=3))
\end_layout

\begin_layout Plain Layout

Data <- rbind(Data, getNetCDF('/Data/ARISTO/ARISTOrf04_LAMSLAMS.nc', VarList,
 F=4))
\end_layout

\begin_layout Plain Layout

rej <- (Data$TASX < 90) | (abs(Data$ROLL) > 5) | (abs(Data$GGVSPD) > 5)
\end_layout

\begin_layout Plain Layout

Data <- Data[!rej,]
\end_layout

\begin_layout Plain Layout

Data$AOAREF <- Data$PITCH - (Data$GGVSPD / Data$TASX) * (180./pi)
\end_layout

\begin_layout Plain Layout

Data$QR <- Data$ADIFR / Data$QCF
\end_layout

\begin_layout Plain Layout

Data$Mach <- MachNumber (Data$PSFD, Data$QCF, Data$EWX)
\end_layout

\begin_layout Plain Layout

fff <- lm (AOAREF ~ QR + I(QR*Mach), data=Data)
\end_layout

\begin_layout Plain Layout

cfall <- coef (fff)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ConventionalCoef, include=TRUE, fig.cap='Angle of attack from the new calibrati
on vs.
 the corresponding value of the reference variable AOAREF.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf02_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

SRD <- getNetCDF (fname, standardVariables(c(VarList)), Start=183200, End=185500
, F=2)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=192100, End=193800
, F=2)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

Flight <- "rf03_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=171300, End=173800
, F=3)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=183400, End=185700
, F=3)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=205500, End=210000
, F=3)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

Flight <- "rf04_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=174300, End=180700
, F=4)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=191200, End=193000
, F=4)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

SR  <- getNetCDF (fname, standardVariables(c(VarList)), Start=202500, End=203900
, F=4)
\end_layout

\begin_layout Plain Layout

SRD <- rbind (SRD, SR)
\end_layout

\begin_layout Plain Layout

SRD$AOAREF <- SRD$PITCH - (SRD$GGVSPD / SRD$TASX) * (180 / pi)
\end_layout

\begin_layout Plain Layout

SRD$QR <- SRD$ADIFR / SRD$QCF
\end_layout

\begin_layout Plain Layout

SRD$Mach <- MachNumber (SRD$PSFD, SRD$QCF, SRD$EWX)
\end_layout

\begin_layout Plain Layout

f <- lm (AOAREF~QR+I(QR*Mach), data=SRD)
\end_layout

\begin_layout Plain Layout

cf <- coefficients(f)
\end_layout

\begin_layout Plain Layout

f2 <- lm (AOAREF~QR+I(QR*Mach), data=SRD[SRD$RF == 2,])
\end_layout

\begin_layout Plain Layout

cf2 <- coefficients(f2)
\end_layout

\begin_layout Plain Layout

f3 <- lm (AOAREF~QR+I(QR*Mach), data=SRD[SRD$RF == 3,])
\end_layout

\begin_layout Plain Layout

cf3 <- coefficients(f3)
\end_layout

\begin_layout Plain Layout

f4 <- lm (AOAREF~QR+I(QR*Mach), data=SRD[SRD$RF == 4,])
\end_layout

\begin_layout Plain Layout

cf4 <- coefficients(f4)
\end_layout

\begin_layout Plain Layout

SRD$AKRDF <- cf[1] + cf[2] * SRD$QR + cf[3] * SRD$QR * SRD$Mach
\end_layout

\begin_layout Plain Layout

layout(matrix(1:1, ncol = 1), widths = 1,  heights = c(6))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(5,4,1,1)+0.1, oma=c(1.1,0,0,0))
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(SRD$AOAREF, SRD$AKRDF), xlab='reference value AOAREF',
 pch=20, type='p')
\end_layout

\begin_layout Plain Layout

lines (c(-2,5), c(-2,5), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:ConventionalCoef}
\end_layout

\end_inset

 shows the resulting fit, with coefficients {
\begin_inset Formula $c_{0},\,c_{1},\,c_{2}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[1], 4)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[2], 4)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[3], 4)}
\end_layout

\end_inset

}.
 However, the results differed for the three flights, and the differences
 were significant, as shown in the following table:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Flight
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
speed runs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[1], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[2], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf[3], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
all rf02–04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfall[1], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfall[2], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfall[3], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf2[1], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf2[2], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf2[3], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3[1], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3[2], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf3[3], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf4[1], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf4[2], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cf4[3], 4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\noindent
Therefore, the individual-flight coefficients will be used to determine
 AKRD and hence WIC in the following studies in this report.
\end_layout

\begin_layout Standard
An additional adjustment of the measurements is useful because the LAMS
 is not installed parallel to the centerline of the aircraft.
 For example, the average measurement of pitch from the LAMS IRU, CPITCH_LAMS,
 is 1.0
\begin_inset Formula $^{\circ}$
\end_inset

 larger than the corresponding measurement of pitch from the Honeywell IRU.
 To account for this offset, it is useful to correct both the pitch and
 angle-of-attack from LAMS by the subtraction of 1.0
\begin_inset Formula $^{\circ}$
\end_inset

 so that the measurements will be comparable to those from the standard
 radome-based system.
 That correction has been made in the following when the LAMS-based angle-of-att
ack is discussed.
\end_layout

\begin_layout Standard
With these corrections, the standard angle-of-attack can be compared to
 that determined from the LAMS.
 The first speed run in the table above will be skipped here because there
 are too many bad measurements from LAMS.
 For the second speed run, Figure
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR2}
\end_layout

\end_inset

 shows the comparison of the two angles of attack.
 There is a clear difference between the two measurements.
 Speed runs #3 and #5 have too much scatter in the LAMS measurements to
 be useful, but speed run #4 has apparently good measurements as shown in
 Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR4}
\end_layout

\end_inset

.
 Here the scatter is much higher than in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR2}
\end_layout

\end_inset

 because this is a low-level flight segment in boundary-layer turbulence,
 but the measurements still show an offset like that in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR2}
\end_layout

\end_inset

, although perhaps with a smaller offset.
 Speed runs #6 and #8 have high scatter and are inconsistent with other
 apparently good speed runs, but speed run #7 led to good agreement between
 the values of the radome-based and LAMS-based angles of attack, as shown
 in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR7}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<SR2, include=TRUE, fig.cap='Angle of attack from the new fit to the radome
 values, plotted against the corresponding anagle-of-attack as measured
 by the LAMS, for speed run 
\backslash

\backslash
#2.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf02_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf2[1] + DW$ADIFR/DW$QCF * (cf2[2] + cf2[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

#r <- setRange (DW, 183200, 185500)
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 192100, 193800)
\end_layout

\begin_layout Plain Layout

DW$ATTACK <- DW$ATTACK - 1
\end_layout

\begin_layout Plain Layout

DW$ATTACK[abs(DW$ATTACK-DW$AKRDF) > 1] <- NA
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSFD, DW$QCF, DW$EWX)
\end_layout

\begin_layout Plain Layout

DW$AOAREF <- Data$PITCH - (Data$GGVSPD / Data$TASX) * (180 / pi)
\end_layout

\begin_layout Plain Layout

fl2 <- lm (ATTACK ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

fa2 <- lm (AOAREF ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

cfl2 <- coef (fl2)
\end_layout

\begin_layout Plain Layout

cfa2 <- coef (fa2)
\end_layout

\begin_layout Plain Layout

DWS <- DW[r,]
\end_layout

\begin_layout Plain Layout

DWS$RF <- rep (2, nrow(DWS))
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$ATTACK[r], DW$AKRDF[r]), xlab='LAMS-based angle of
 attack',
\end_layout

\begin_layout Plain Layout

        ylab='new fit for radome-based angle of attack', pch=20, type='p',
 xlim=c(-2,5),
\end_layout

\begin_layout Plain Layout

        ylim=c(-2,5))
\end_layout

\begin_layout Plain Layout

lines (c(-2,5), c(-2,5), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<SR4, include=TRUE, fig.cap='Angle of attack from the new fit to the radome
 values, plotted against the corresponding anagle-of-attack as measured
 by the LAMS, for speed run 
\backslash

\backslash
#4.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf03_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf3[1] + DW$ADIFR/DW$QCF * (cf3[2] + cf3[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

#r <- setRange (DW, 183200, 185500)
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 171300, 173800)
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 183400, 185700)
\end_layout

\begin_layout Plain Layout

DW$ATTACK <- DW$ATTACK - 1
\end_layout

\begin_layout Plain Layout

DW$ATTACK[abs(DW$ATTACK-DW$AKRDF) > 4] <- NA
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSFD, DW$QCF, DW$EWX)
\end_layout

\begin_layout Plain Layout

fl4 <- lm (ATTACK ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$ATTACK[r], DW$AKRDF[r]), xlab='LAMS-based angle of
 attack',
\end_layout

\begin_layout Plain Layout

        ylab='new fit for radome-based angle of attack', pch=20, type='p',
 xlim=c(-2,5),
\end_layout

\begin_layout Plain Layout

        ylim=c(-2,5))
\end_layout

\begin_layout Plain Layout

lines (c(-2,5), c(-2,5), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<SR7, include=TRUE, fig.cap='Angle of attack from the new fit to the radome
 values, plotted against the corresponding anagle-of-attack as measured
 by the LAMS, for speed run 
\backslash

\backslash
#7.
 Some additional outlier points having difference between the measurements
 larger than 1 degree have been excluded from the plot.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf04_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf4[1] + DW$ADIFR/DW$QCF * (cf4[2] + cf4[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 191200, 193000)
\end_layout

\begin_layout Plain Layout

DW$ATTACK <- DW$ATTACK - 1
\end_layout

\begin_layout Plain Layout

DW$ATTACK[abs(DW$ATTACK-DW$AKRDF) > 1] <- NA
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSFD, DW$QCF, DW$EWX)
\end_layout

\begin_layout Plain Layout

DW$AOAREF <- Data$PITCH - (Data$GGVSPD / Data$TASX) * (180 / pi)
\end_layout

\begin_layout Plain Layout

fl7 <- lm (ATTACK ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

fa7 <- lm (AOAREF ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

cfl7 <- coef (fl7)
\end_layout

\begin_layout Plain Layout

cfa7 <- coef (fa7)
\end_layout

\begin_layout Plain Layout

DW$RF <- rep (7, nrow(DW))
\end_layout

\begin_layout Plain Layout

DWS <- rbind (DWS, DW[r,])
\end_layout

\begin_layout Plain Layout

fl <- lm (ATTACK ~ QR + I(QR*Mach), data=DWS)
\end_layout

\begin_layout Plain Layout

cfl <- coef (fl)
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$ATTACK[r], DW$AKRDF[r]), xlab='LAMS-based angle of
 attack',
\end_layout

\begin_layout Plain Layout

        ylab='new fit for radome-based angle of attack', pch=20, type='p',
 xlim=c(-2,5),
\end_layout

\begin_layout Plain Layout

        ylim=c(-2,5))
\end_layout

\begin_layout Plain Layout

lines (c(-2,5), c(-2,5), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

DW$TASL <- DW$TASX
\end_layout

\begin_layout Plain Layout

DW$TASX <- Data$TASX
\end_layout

\begin_layout Plain Layout

DSR <- DW[r, ]    ## save this for later use
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR2}
\end_layout

\end_inset

 and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR7}
\end_layout

\end_inset

 show reasonable consistency between the two measurements, while there is
 a significant offset evident in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR4}
\end_layout

\end_inset

.
 Because speed run #4 is a low-level boundary-layer leg, there may be bias
 introduced by the proximity of the ground and strong reflection from it
 that could affect the downward-pointing beam.
 A fit to the radome-based angle of attack as a function of the LAMS-based
 value gave regression coefficients of 0.66 (offset) and 0.70 (slope), so
 these measurements are clearly inconsistent.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
clearpage
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A revised LAMS-based calibration for the radome sensitivity coefficients
 can then be determined by using the LAMS-based angle of attack as the reference
 for the fits.
 Separate fits for speed-run #2 and for #7 produced significantly different
 results, so both the conventional and LAMS-based calibrations differ for
 the two speed runs.
 The following table summarizes the results:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
speed run
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
source of calibration
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{0}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $c_{2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AOAREF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfa2[1],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfa2[2],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS ATTACK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl2[1],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl2[2],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AOAREF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfa7[1],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfa7[2],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS ATTACK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl7[1],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl7[2],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
#2+#7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS ATTACK
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl[1],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl[2],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfl[3],4)}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<summary-plot,include=TRUE, fig.cap="Comparison of the standard and LAMS-based
 calibrations for speed run 
\backslash

\backslash
#7.">>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

xx <- -0.5 + (1.3-0.5) / 40 * (0:41)
\end_layout

\begin_layout Plain Layout

yyl7 <- cfl7[1] +cfl7[2]*xx
\end_layout

\begin_layout Plain Layout

yyl2 <- cfl2[1] +cfl2[2]*xx
\end_layout

\begin_layout Plain Layout

yya7 <- cfa7[1] +cfa7[2]*xx
\end_layout

\begin_layout Plain Layout

yya2 <- cfa2[1] +cfa2[2]*xx
\end_layout

\begin_layout Plain Layout

dfp <- data.frame (xx, 'standard SR7'=yya7, 'LAMS SR7'=yyl7, 'standard SR2'=yya2,
 'LAMS SR2'=yyl2)
\end_layout

\begin_layout Plain Layout

plotWAC(dfp, xlab='ADIFR/QCF', ylab='angle of attack',type='l', 
\end_layout

\begin_layout Plain Layout

        col=c('blue', 'red', 'darkgreen', 'black'),
\end_layout

\begin_layout Plain Layout

        lwd=c(2,3,2,3), lty=c(1,3,1,3), legend.position='topleft')
\end_layout

\begin_layout Plain Layout

# lineWAC(xx, yyl2, col='darkgreen', lwd=2)
\end_layout

\begin_layout Plain Layout

# lineWAC(xx,yya2, col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

# legend('topleft', c('standard', 'LAMS'), col=c('blue', 'red'), lty=c(1,2),
 lwd=c(2,3))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The four calibrations in the preceding table are plotted in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:summary-plot}
\end_layout

\end_inset

.
 For speed run #7, the calibrations based on LAMS and on AOAREF are close
 to the same, although there are small differences of typical magnitude
 of about 0.1
\begin_inset Formula $^{\circ}$
\end_inset

for angles-of-attack in the typical range of operations (0–4
\begin_inset Formula $^{\circ}$
\end_inset

).
 However, the different calibrations for speed run #2 are not as consistent,
 and both calibrations differ significantly from those for speed run #7.
 A fit to the combined data from #2 and #7 is also shown for the LAMS calibratio
n, but this fit was much worse than the individual-flight calibrations and
 showed two distinct lines with little overlap for the two plots, so this
 is not a good calibration to use for these flights.
 For the conventional calibration, the differencemight be attributed to
 a non-zero vertical wind during the calibration maneuver, but the LAMS
 calibration is not affected by the vertical wind so it should be definitive
 unless there was some problem with detection of the LAMS beams.
 Other possibilities are drift of the CPITCH_LAMS measurement or differences
 in altitude or Mach number.
 However, the difference between PITCH and CPITCH_LAMS is the same for speed
 run #2 as for speed run #7 and both were flown at almost the same altitude
 and range in Mach number, so these explanations appear to be ruled out.
 
\end_layout

\begin_layout Standard
The result is that the two best speed runs, #2 and #7, are inconsistent.
 Calibrations for speed run #7 support the validity of each, but there is
 larger than expected difference between the two calibrations for #2 and
 between the corresponding calibrations for #7 vs #2.
 These are the best calibration data available, so more measurements with
 adequate LAMS signal-to-noise would be valuable.
 Pending such measurements, the LAMS-based calibration for #7 may be the
 most reliable.
\end_layout

\begin_layout Standard
Another conclusion from the study of the speed runs is that the PCA analysis
 does not always produce reliable line-of-sight speeds.
 A good example is speed run #6.
 There are values for all four beam line-of-sight speeds through this maneuver,
 and the speed in the forward beam (Beam 2) matches the true airspeed (TASX)
 well.
 However, Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:SR6}
\end_layout

\end_inset

 shows that the angle-of-attack determined from these measurements does
 not match that determined from the radome-based system and looks very noisy.
 This raises a warning that sometimes the line-of-sight speeds are not valid
 even when the PCA algorithm detects peak values.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<SR6, include=TRUE, fig.cap='Angle of attack from the new fit to the radome
 values (blue line) and the angle-of-attack determined from the LAMS measurement
s (green line), for speed run 
\backslash

\backslash
#6.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf04_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf3[1] + DW$ADIFR/DW$QCF * (cf3[2] + cf3[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

#r <- setRange (DW, 183200, 185500)
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 174300, 180700)
\end_layout

\begin_layout Plain Layout

# r <- setRange (DW, 183400, 185700)
\end_layout

\begin_layout Plain Layout

DW$ATTACK <- DW$ATTACK - 1
\end_layout

\begin_layout Plain Layout

DW$ATTACK[abs(DW$ATTACK-DW$AKRDF) > 4] <- NA
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSFD, DW$QCF, DW$EWX)
\end_layout

\begin_layout Plain Layout

fl4 <- lm (ATTACK ~ QR, data=DW[r,])
\end_layout

\begin_layout Plain Layout

# plotWAC(data.frame(DW$ATTACK[r], DW$AKRDF[r]), xlab='LAMS-based angle of
 attack',
\end_layout

\begin_layout Plain Layout

#         ylab='new fit for radome-based angle of attack', pch=20, type='p',
 xlim=c(-2,5),
\end_layout

\begin_layout Plain Layout

#         ylim=c(-2,5))
\end_layout

\begin_layout Plain Layout

# lines (c(-2,5), c(-2,5), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

plotWAC(subset(DW[r,],,c(Time,AKRDF, ATTACK)))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Sideslip angle
\end_layout

\begin_layout Standard
There were four yaw maneuvers that can be used to find the sensitivity coefficie
nts for the sideslip measurement, as listed in the following table:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
maneuver #
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
flight
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
end
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
194100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
194330
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
182800
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
183100
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
190130
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
190400
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
201830
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
202130
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
First, for completeness, the conventional fit will be used:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\beta^{*}=-\Psi+\arctan\frac{u_{p}-u}{v_{p}-v}
\]

\end_inset

where 
\begin_inset Formula $\beta^{*}$
\end_inset

 is the reference value for the fit, 
\begin_inset Formula $\Psi$
\end_inset

 is the heading, 
\begin_inset Formula $u_{p}$
\end_inset

 and 
\begin_inset Formula $v_{p}$
\end_inset

 the eastward and northward components of the aircraft ground-speed and
 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 are the east and north components of the wind.
 The empirical relationship for sideslip then can be found by fitting for
 the coefficients {
\begin_inset Formula $s_{0},\,s_{1}$
\end_inset

} in:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\beta^{*}=b_{0}+b_{1}\frac{\mathrm{BDIFR}}{\mathrm{QCXC}}
\]

\end_inset

and then finding the sideslip angle from
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\mathrm{SSRD}=b_{0}+b_{1}\frac{\mathrm{BDIFR}}{\mathrm{QCXC}}\,\,\,.
\]

\end_inset

Figure 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:sslip-cal}
\end_layout

\end_inset

 shows that the resulting values for 
\begin_inset Formula $\mathrm{SSRD}$
\end_inset

 are in close correspondence to the reference values for the four combined
 yaw maneuvers.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sslip-cal, include=TRUE, fig.cap='Sideslip angle calculated using new fit
 coefficients (SSRD) as a function of the reference value for sideslip (SSREF).
 The relationship determined by regression is shown as the dashed orange
 line.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf02_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

VarList <- c(VarList, 'VEW', 'VNS')
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)), Start=194100, End=19433
0, F=1)
\end_layout

\begin_layout Plain Layout

DW <- processWind (Data)
\end_layout

\begin_layout Plain Layout

DW$RF <- rep(1, nrow(DW))
\end_layout

\begin_layout Plain Layout

DW$BQR <- Data$BDIFR / Data$QCXC
\end_layout

\begin_layout Plain Layout

Flight <- 'rf04_LAMS'
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

D <- getNetCDF (fname, standardVariables(c(VarList)), F=2)
\end_layout

\begin_layout Plain Layout

DW2 <- processWind (D)
\end_layout

\begin_layout Plain Layout

DW2$RF <- rep (2, nrow(DW2))
\end_layout

\begin_layout Plain Layout

DW2$BQR <- D$BDIFR / D$QCXC
\end_layout

\begin_layout Plain Layout

Data <- rbind (Data, D[setRange(D, 182800, 183100),])
\end_layout

\begin_layout Plain Layout

DW <- rbind (DW, DW2[setRange(D, 182800, 183100),])
\end_layout

\begin_layout Plain Layout

r <- setRange(D, 190130, 190400)
\end_layout

\begin_layout Plain Layout

D$RF[r] <- 3
\end_layout

\begin_layout Plain Layout

DW2$RF[r] <- 3
\end_layout

\begin_layout Plain Layout

Data <- rbind (Data, D[r,])
\end_layout

\begin_layout Plain Layout

DW <- rbind (DW, DW2[r,])
\end_layout

\begin_layout Plain Layout

r <- setRange(D, 201830, 202130)
\end_layout

\begin_layout Plain Layout

D$RF[r] <- 4
\end_layout

\begin_layout Plain Layout

DW2$RF[r] <- 4
\end_layout

\begin_layout Plain Layout

DW <- rbind (DW, DW2[r,])
\end_layout

\begin_layout Plain Layout

Data <- rbind (Data, D[r,])
\end_layout

\begin_layout Plain Layout

Cradeg <- pi / 180.
\end_layout

\begin_layout Plain Layout

u <- -1.
 * Data$WSC * sin (Data$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

v <- -1.
 * Data$WSC * cos (Data$WDC*Cradeg)
\end_layout

\begin_layout Plain Layout

Data$SSREF <- -Data$THDG + atan2((Data$GGVEW-u), (Data$GGVNS-v))/ Cradeg
\end_layout

\begin_layout Plain Layout

Data$SSREF[Data$SSREF < -180.] <- Data$SSREF[Data$SSREF < -180.] + 360.
\end_layout

\begin_layout Plain Layout

#plot (DataV$SSREF, DataV$SSLIP, pch=16, cex=0.6,col='blue')
\end_layout

\begin_layout Plain Layout

Data$BQR <- Data$BDIFR / Data$QCXC
\end_layout

\begin_layout Plain Layout

sfm <- lm(SSREF~BQR, data=Data)
\end_layout

\begin_layout Plain Layout

cfs <- coefficients(sfm)
\end_layout

\begin_layout Plain Layout

# print (sprintf('fit coefficients %.4f %.4f', cfs[1], cfs[2])) 
\end_layout

\begin_layout Plain Layout

Data$S2 <- cfs[1] + cfs[2] * Data$BQR
\end_layout

\begin_layout Plain Layout

with(Data, plotWAC(data.frame(SSREF, S2), xlab='SSREF', ylab='SSRD', pch=20,
 type='p'))
\end_layout

\begin_layout Plain Layout

lines (c(-6,6), c(-6,6), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

DWfit <- DW[DW$RF == 1,]
\end_layout

\begin_layout Plain Layout

DWfit <- DWfit[setRange (DWfit, 194150, 194305),]
\end_layout

\begin_layout Plain Layout

DWfit <- rbind (DWfit, DW[DW$RF == 4,])
\end_layout

\begin_layout Plain Layout

fls <- lm (DWfit$SSLIP ~ DWfit$BQR)
\end_layout

\begin_layout Plain Layout

cfls <- coef(fls)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
The resulting sensitivity coefficients for sideslip are {
\begin_inset Formula $b_{0},\,b{}_{1}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfs[1], 4)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfs[2], 4)}
\end_layout

\end_inset

}.
 The fit was very good, with a residual standard deviation of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(sfm)$sigma, 2)}
\end_layout

\end_inset


\begin_inset Formula $^{\circ}$
\end_inset

.
 For comparison, the standard values in the Technical Note on Processing
 Algorithms are {0, 12.2115}.
 As discussed in the Technical Note on Wind Uncertainty, it is difficult
 to separate an offset in sideslip from an offset in heading, so the difference
 in the first coefficient may instead apply to heading.
\begin_inset Foot
status open

\begin_layout Plain Layout
An offset of -0.1
\begin_inset Formula $^{\circ}$
\end_inset

 applied to heading in the original processing has not been removed here.
\end_layout

\end_inset

 The difference in offsets for these two calibrations is large, although
 the slope coefficients are in reasonable agreement.
 
\end_layout

\begin_layout Standard
The LAMS measurement of sideslip provides an alternate means of determining
 the slope parameter.
\begin_inset Foot
status open

\begin_layout Plain Layout
The appropriate offsets in sideslip and heading will still need to be found
 from analysis of circle maneuvers.
\end_layout

\end_inset

 The reference value 
\begin_inset Formula $\beta^{*}$
\end_inset

 for the fit can be determined from the LAMS-based measurements of the relative
 wind, as discussed in the introductory section:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\beta^{*}=\arctan\left(\frac{\mathrm{RW}_{y}}{\mathrm{RW}_{x}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
The LAMS-based measurements of sideslip bear little similarity to those
 from the radome for sideslip maneuvers #2 and #3, so there are evidently
 measurement problems that make those unreliable.
 Maneuver #4 is good, and maneuver #1 appears valid for the period 194130–194305
, so those measurements were used for the fit.
 The LAMS-based fit gave coefficients {
\begin_inset Formula $b_{0},\,b_{1}$
\end_inset

} = {
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfls[1], 4)}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfls[2], 4)}
\end_layout

\end_inset

}, with a residual standard deviation about the fit of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(fls)$sigma, 2)}
\end_layout

\end_inset


\begin_inset Formula $^{\circ}$
\end_inset

.
 These values are close to those determined in the standard way, so this
 calibration provides support for the conventional approach, although the
 difference in slope is significant (with estimated standard uncertainty
 in 
\begin_inset Formula $b_{1}$
\end_inset

 of 0.05
\begin_inset Formula $^{\circ}$
\end_inset

).
 The value for 
\begin_inset Formula $b_{1}$
\end_inset

 determined from the LAMS-based measurements, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(cfls[2], 2)}
\end_layout

\end_inset


\begin_inset Formula $^{\circ}$
\end_inset

, appears to be the best available, but the value of 
\begin_inset Formula $b_{0}$
\end_inset

 still needs to be determined from the circle maneuvers that can separate
 an offset in sideslip from an offset in heading.
\end_layout

\begin_layout Section*
Calibration of the pressure defect
\end_layout

\begin_layout Standard
A previous calibration of the C-130 pressure defect was published in Cooper
 et al., 2014.
 The key to this calibration is that LAMS provides a measurement of airspeed,
 from which the dynamic pressure can be calculated if the temperature and
 pressure are known.
 The result is relatively insensitive to temperature and pressure, so this
 is an accurate result despite the need to know the airspeed to calculate
 the temperature and the need to know the static defect to calculate the
 pressure.
 Because a pitot tube is thought to provide a valid measurement of the total
 pressure, subtracting the dynamic pressure from the total pressure gives
 the true ambient pressure.
 The difference between this value and the measured pressure is then the
 static defect.
 Furthermore, because the measured dynamic pressure is based on a measurement
 of the difference between the total and static pressures, the same correction
 represented by the static defect applies with reversed sign to the measured
 dynamic pressure.
\end_layout

\begin_layout Standard
The equation published there, Eq.
\begin_inset space ~
\end_inset

11, was subsequently revised to avoid circularity in data processing by
 basing the empirical relationship on uncorrected quantities, as discussed
 in the Technical Note on Processing Algorithms [version as of June 2016].
 For the C-130, the error in the measurement of ambient or static pressure
 (
\begin_inset Formula $\Delta p$
\end_inset

) was found to be given by the following empirical representation, to an
 uncertainty of less than 0.3
\begin_inset space ~
\end_inset

hPa:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\frac{\Delta p}{p}=a_{0}+a_{1}\frac{\alpha}{a_{r}}+a_{2}M\label{eq:PCOR}
\end{equation}

\end_inset

where 
\begin_inset Formula $p$
\end_inset

 is the uncorrected measurement of pressure (PSFD or PSFRD), 
\begin_inset Formula $\alpha$
\end_inset

 is the angle of attack (AKRD), calculated from uncorrected measurements
 as described in the Algorithms document, 
\begin_inset Formula $a_{r}$
\end_inset

 is a constant with value 1
\begin_inset Formula $^{\circ}$
\end_inset

 (included only to keep the equation dimensionless), and 
\begin_inset Formula $M$
\end_inset

 is the Mach number calculated from uncorrected measurements of static and
 dynamic pressure.
 The coefficients are {
\begin_inset Formula $a_{0},\,a_{1},\,a_{2}$
\end_inset

} = {
\begin_inset Formula $-$
\end_inset

0.00637, 0.001366, 0.0149} for PSFD and {
\begin_inset Formula $-$
\end_inset

0.00754, 0.000497, 0.0368} for the alternate pressure measurement PSFRD.
 These coefficients were based on measurements collected during the IDEAS
 project of November 2011.
 They appeared to work well for many subsequent projects, as judged by consisten
cy with the avionics-provided pressure PS_A.
 A representative example from the FRAPPE measurements is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:PSA-FRAPPE}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<PSA-FRAPPE, include=TRUE, fig.cap='The difference between the avionic-provided
 pressure (PS
\backslash

\backslash
_A) and the standard pressure after the correction as expressed in (1) (PSFDC).'>
>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

fname <- '/Data/FRAPPE/FRAPPErf05.nc'
\end_layout

\begin_layout Plain Layout

VList <- c('PS_A', 'PS_A2', 'PSFC', 'PSFDC', 'PSFD', 'PSFRD', 'QCF', 'AKRD')
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables (VList))
\end_layout

\begin_layout Plain Layout

Data <- Data[Data$TASX > 80,]
\end_layout

\begin_layout Plain Layout

with (Data, hist (PS_A-PSFDC, breaks=300, xlim=c(1,4)))
\end_layout

\begin_layout Plain Layout

dPA <- with (Data, mean (PS_A-PSFDC, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

# with (Data, plotWAC (data.frame (PS_A, PSFDC), xlab='PS_A', ylab='PSFDC',
 pch=20, type='p'))
\end_layout

\begin_layout Plain Layout

# lines(c(500,900), c(500,900), col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<TAS-comparison, include=TRUE, fig.cap='The conventional measurement of
 airspeed (TASX) plotted vs.
\backslash

\backslash
 the LAMS-derived measurement of airspeed (TASL), for speed run 
\backslash

\backslash
#7.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

with (DSR, plotWAC(data.frame(TASL, TASX), xlab='LAMS TAS', ylab='TASX',
 pch=20, type='p'))
\end_layout

\begin_layout Plain Layout

# with (DSR, hist (TASX-TASL, breaks=100, xlim=c(-2,2)))
\end_layout

\begin_layout Plain Layout

DTAS <-with(DSR, mean (TASX-TASL, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

SDTAS <- with(DSR, sd (TASX-TASL, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The mean offset between the avionics-supplied pressure and the research
 pressure is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(dPA, 1)}
\end_layout

\end_inset


\begin_inset space ~
\end_inset

hPa, a value that is similar to those measured in other projects including
 NOMADSS, WINTER, and ARISTO-2015.
 It appears that the pressure correction is providing consistent results
 for recent C-130 projects.
 Further evidence is provided by a comparison of airspeed as measured by
 the LAMS and the conventional system employing the above PCOR function,
 as shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:TAS-comparison}
\end_layout

\end_inset

.
 The mean difference between the LAMS-measured airspeed and the standard
 airspeed was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(DTAS, 2)}
\end_layout

\end_inset


\begin_inset space ~
\end_inset

m/s and the standard deviation for 1-Hz measurements was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(SDTAS, 2)}
\end_layout

\end_inset


\begin_inset space ~
\end_inset

m/s.
 Because the LAMS-derived airspeed is smaller, even this small difference
 might arise from some airflow distortion at the displaced positions of
 the LAMS beams.
 There is some additional evidence for this in the next section.
\end_layout

\begin_layout Standard
These checks indicate that the usual PCOR function is working well for this
 C-130 project.
 The weakness is the available calibrations, present also in ARISTO-2015,
 is that measurements at altitudes between sea level and about 850
\begin_inset space ~
\end_inset

hPa have not been available.
 Problems may arise with use of the PCOR function as expressed in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:PCOR"

\end_inset

) to such low-level flight, so it will be important to revisit the determination
 of the empirical relationship for the static defect once such low-level
 measurements are available.
\end_layout

\begin_layout Section*
LAMS-based measurement of temperature
\end_layout

\begin_layout Subsection*
Theory and data available
\end_layout

\begin_layout Standard
It was demonstrated in Cooper et al.
\begin_inset space ~
\end_inset

(2014) that the LAMS-measured airspeed 
\begin_inset Formula $v_{L}$
\end_inset

 can be used to measure the temperature in a way that is independent of
 any temperature sensor.
 One important aspect of this is that 
\begin_inset Formula $v_{l}$
\end_inset

, combined with the measurements of total pressure (
\begin_inset Formula $p_{t}$
\end_inset

) and of ambient pressure (
\begin_inset Formula $p$
\end_inset

), might provide a valid measurement of temperature in clouds.
 This independent measurement of temperature arises from the relationship
 between temperature and the speed of sound, because the Mach number (
\begin_inset Formula $M$
\end_inset

) can be determined from the measurements 
\begin_inset Formula $p_{t}$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 so the speed of sound can be found from 
\begin_inset Formula $v_{L}/M$
\end_inset

.
 That measurement of temeperature will be explored in this section.
\end_layout

\begin_layout Standard
The equation leading to temperature, Eq.
\begin_inset space ~
\end_inset

(24) in Cooper et al.
\begin_inset space ~
\end_inset

(2014), is
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
T=\frac{v_{l}^{2}}{2c_{p}\left[\left(\frac{p_{t}}{p}\right)^{R_{a}/c_{p}}-1\right]}\label{eq:T-LAMS}
\end{equation}

\end_inset

where 
\begin_inset Formula $T$
\end_inset

 is the temperature on an absolute-temperature scale, 
\begin_inset Formula $c_{p}$
\end_inset

 is the specific heat of air at constant pressure, and 
\begin_inset Formula $R_{a}$
\end_inset

 is the gas constant for air.
 For a selected region with strong LAMS signals in clear air, the resulting
 temperature (converted to 
\begin_inset Formula $^{\circ}$
\end_inset

C) was on average 1.4
\begin_inset Formula $^{\circ}$
\end_inset

C lower than the standard temperature ATX.
 However, this result is very sensitive to 
\begin_inset Formula $v_{L}$
\end_inset

 and increasing 
\begin_inset Formula $v_{l}$
\end_inset

 by 0.35 m/s (the measured difference between 
\begin_inset Formula $v_{L}$
\end_inset

 and TASX) completely removed the offset.
 That may be an indication that the airspeed from LAMS shows a small effect
 from airflow distortion even though the beams are displaced XXX m ahead
 of the instrument.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<T-comparison, include=FALSE, fig.cap='LAMS-derived temperature (TL) vs
 the standard measurement (ATX) for ARISTO-2015 flight 4, 19:12:00--19:30:00
 UTC.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf04_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList)))
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$PSXC <- Data$PSXC
\end_layout

\begin_layout Plain Layout

DW$QCXC <- Data$QCXC
\end_layout

\begin_layout Plain Layout

DW$ATX <- Data$ATX
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf4[1] + DW$ADIFR/DW$QCF * (cf4[2] + cf4[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 191200, 193000)
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSXC, DW$QCXC, DW$EWX)
\end_layout

\begin_layout Plain Layout

DW$TASL <- DW$TASX
\end_layout

\begin_layout Plain Layout

DW$TASX <- Data$TASX
\end_layout

\begin_layout Plain Layout

DW <- DW[r, ]
\end_layout

\begin_layout Plain Layout

CP <- SpecificHeats (DW$EWX / DW$PSXC)
\end_layout

\begin_layout Plain Layout

cpa <- CP[,1]
\end_layout

\begin_layout Plain Layout

Ra <- CP[,3]
\end_layout

\begin_layout Plain Layout

cva <- CP[,2]
\end_layout

\begin_layout Plain Layout

gamma <- cpa/cva
\end_layout

\begin_layout Plain Layout

Vs <- (DW$TASL) / DW$Mach
\end_layout

\begin_layout Plain Layout

TL <- Vs^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

# TL <- DW$TASL^2 / (2*cpa * (((DW$PSXC+DW$QCXC)/DW$PSXC)^(Ra/cpa) - 1))
 - 273.15
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$ATX, TL), xlab='ATX', ylab='LAMS-based T', pch=20,
 type='p', xlim=c(-5,-2), ylim=c(-20,10))
\end_layout

\begin_layout Plain Layout

cflt <- coef (lm (TL ~ DW$ATX))
\end_layout

\begin_layout Plain Layout

xt <- c(-10,10)
\end_layout

\begin_layout Plain Layout

yt <- cflt[1] + cflt[2]*xt
\end_layout

\begin_layout Plain Layout

lines (xt, yt, col='darkorange', lwd=3, lty=2)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To investigate the performance of this measurement of temperature in cloud,
 the in-cloud measurements from ARISTO-2015 were examined.
 The in-cloud measurements included those in the following table, along
 with a few other brief passes through rain, ice, or cloud:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
flight
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
start
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
end
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
nature of cloud
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
performance of LAMS
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
173000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
173800
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
warm, no 2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mostly NG
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
174145
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
174600
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
warm, no 2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
maybe OK
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
184740
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
184830
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
only 2D; cold
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OK
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
173000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
warm; high 2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sporadic, weak
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
181000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
182000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
repeated cloud, warm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
questionable, maybe OK
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
200900
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
201000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
short, warm cloud
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS good
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
171500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
172500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cold, ice
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS mostly OK
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
173000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
174500
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cold, ice
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Beam1 NG, others weak
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
170600
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
171100
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
near 0C, short
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Beam2 OK; Beam1 gaps
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
182200
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
182400
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2D only; cold
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
LAMS NG
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<LAMST-1, include=TRUE, fig.cap='The temperature deduced from the measurement
 obtained using the LAMS-measured airspeed (magenta dots), adjusted as described
 in the text, and plotted with a smoothed version (TLS) and with the standard
 measurement of temperature (ATX).
 The measurements from periods where the CDP concentration exceeded 5
\backslash

\backslash
_cm$^{-3}$ are shown as thicker lines plotted, in the case of ATX, in a
 different color.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf03_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList, "CONCD_RPT")))
\end_layout

\begin_layout Plain Layout

## these points appear to be bad, beam 2:
\end_layout

\begin_layout Plain Layout

Data$BEAM2speed[getIndex(Data, 200951)] <- NA
\end_layout

\begin_layout Plain Layout

Data$BEAM2speed[getIndex(Data, 200948)] <- NA
\end_layout

\begin_layout Plain Layout

Data$BEAM2speed[getIndex(Data, 200954)] <- NA
\end_layout

\begin_layout Plain Layout

PCA <- FALSE    ## use SG polynomial solution
\end_layout

\begin_layout Plain Layout

# PCA <- TRUE     ## use PCA solution
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$BEAM2speed <- Data$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$PSXC <- Data$PSXC
\end_layout

\begin_layout Plain Layout

DW$QCXC <- Data$QCXC
\end_layout

\begin_layout Plain Layout

DW$ATX <- Data$ATX
\end_layout

\begin_layout Plain Layout

DW$CONCD <- Data$CONCD_RPT
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf4[1] + DW$ADIFR/DW$QCF * (cf4[2] + cf4[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 200830, 201030)
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSXC, DW$QCXC, DW$EWX)
\end_layout

\begin_layout Plain Layout

DW$TASL <- DW$TASX
\end_layout

\begin_layout Plain Layout

## temporary: use beam 2 only
\end_layout

\begin_layout Plain Layout

# DW$TASL <- DW$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$TASL3 <- (Data$BEAM1speed + DW$BEAM3speed + DW$BEAM4speed) / (3 * cos
 (35*pi/180))
\end_layout

\begin_layout Plain Layout

DW$TASL1 <- Data$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$TASX <- Data$TASX
\end_layout

\begin_layout Plain Layout

DW <- DW[r, ]
\end_layout

\begin_layout Plain Layout

CP <- SpecificHeats (DW$EWX / DW$PSXC)
\end_layout

\begin_layout Plain Layout

cpa <- CP[,1]
\end_layout

\begin_layout Plain Layout

Ra <- CP[,3]
\end_layout

\begin_layout Plain Layout

cva <- CP[,2]
\end_layout

\begin_layout Plain Layout

gamma <- cpa/cva
\end_layout

\begin_layout Plain Layout

DTAS <- with(DW, mean (TASX-TASL, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

DTAS3 <- with (DW, mean (TASX-TASL3, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

DTAS1 <- with (DW, mean (TASX-TASL1, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

Vs <- (DW$TASL + DTAS) / DW$Mach
\end_layout

\begin_layout Plain Layout

Vs3 <- (DW$TASL3 + DTAS3) / DW$Mach
\end_layout

\begin_layout Plain Layout

Vs1 <- (DW$TASL1 + DTAS1) / DW$Mach
\end_layout

\begin_layout Plain Layout

TL <- Vs^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

TL3 <- Vs3^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

TL1 <- Vs1^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

LS <- 13
\end_layout

\begin_layout Plain Layout

TLS <- SmoothInterp (TL, .Length=LS)
\end_layout

\begin_layout Plain Layout

TLS1 <- SmoothInterp (TL1, .Length=LS)
\end_layout

\begin_layout Plain Layout

TLS3 <- SmoothInterp (TL3, .Length=LS)
\end_layout

\begin_layout Plain Layout

# TL <- DW$TASL^2 / (2*cpa * (((DW$PSXC+DW$QCXC)/DW$PSXC)^(Ra/cpa) - 1))
 - 273.15
\end_layout

\begin_layout Plain Layout

layout(matrix(1:2, ncol = 1), widths = 1,  heights = c(5,6))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(2,4,1,1)+0.1, oma=c(1.1,0,0,0))
\end_layout

\begin_layout Plain Layout

ATX <- DW$ATX
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$Time, ATX, TLS), ylab='Temperature [C]', 
\end_layout

\begin_layout Plain Layout

        ylim=c(5,17), lwd=c(2,2), lty=c(1,2), legend.position='topright')
\end_layout

\begin_layout Plain Layout

Excl <- DW$CONC < 5
\end_layout

\begin_layout Plain Layout

ATX[Excl] <- NA
\end_layout

\begin_layout Plain Layout

TLS[Excl] <- NA
\end_layout

\begin_layout Plain Layout

lines (DW$Time+0.5, ATX, lwd=4, col='cyan')
\end_layout

\begin_layout Plain Layout

lines (DW$Time+0.5, TLS, lwd=4, col='darkgreen')
\end_layout

\begin_layout Plain Layout

points (DW$Time, TL, pch=20, col='magenta')
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(5,4,1,1)+0.1)
\end_layout

\begin_layout Plain Layout

plotWAC(subset(DW,, c(Time, CONCD)))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Case 1: Flight 3, 20:09:00 to 20:10:00
\end_layout

\begin_layout Standard
Flight 3, 20:09:00 to 20:10:00, is a short pass through a warm cloud with
 no ice or rain.
 Close inspection of the forward-pointing beam (beam 2) indicates that there
 are a few bad points in the center of this cloud, at times 20:09:48, 20:09:51.
 and 20:09:54, so these were set missing and then interpolation was used
 to fill in missing points in this time period.
\begin_inset Foot
status open

\begin_layout Plain Layout
Beam 2 appeared to be affected in cloud more than the other beams, perhaps
 because of water striking and remaining on the forward-pointing aperture
 more than on the other beams pointing 35
\begin_inset Formula $^{\circ}$
\end_inset

 from the forward direction.
\end_layout

\end_inset

 The mean difference between airspeed determined in the conventional way
 and airspeed from LAMS was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(DTAS, 2)}
\end_layout

\end_inset


\begin_inset space ~
\end_inset

m/s, consistent with the value found in the clear-air flight segment used
 in the preceding paragraph.
 To make it easier to judge differences produced by the cloud, this mean
 value was added to the LAMS-measured airspeeds and then smoothing over
 approximately a 5-s period was applied to the temperature calculated from
 the LAMS airspeed.
 The resulting temperature measurement for the cloud pass is shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:LAMST-1}
\end_layout

\end_inset

, where the magenta-colored points are the unsmoothed measurements of temperatur
e.
 The unsmoothed measurement is quite noisy, so smoothing is important in
 order to see trends.
\begin_inset Foot
status open

\begin_layout Plain Layout
ATX is not smoothed, but it is thought to have a response time between 2
 and 3 s.
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
Despite the noisy signal, particularly in the vicinity of the clouds, the
 LAMS-based temperature shows good correlation with the standard temperature.
 There is also a suggestion of a trend in the cloud passes: As the cloud
 pass proceeds, ATX tends to become lower relative to TLS.
 Because of the variability present, this is only suggestive, but there
 is some match to what would be expected if the ATX sensor (in this case,
 a HARCO anti-iced sensor) becomes wet in cloud because in that case evaporative
 cooling from the element in the dynamically heated and therefore <100%-humidity
 air in the housing causes an error of negative sign.
\end_layout

\begin_layout Subsection*
Case 2: Flight 2, 17:30:00–19:20:00 
\end_layout

\begin_layout Standard
Next, the long cloud pass from flight 2 was examined.
 These measurements were from a low-level flight leg (near 7000 ft) at high
 temperature, >10
\begin_inset Formula $^{\circ}$
\end_inset

C, and there were high concentrations of particles measured by the 2DC.
 The LAMS-measured line-of-sight speeds were not always reliable,but it
 was possible to select regions of strong and apparently consistent signals
 from this long cloud pass.
 CDP-measured concentrations were often several hundred cm
\begin_inset Formula $^{-3}$
\end_inset

, and 2D-measured concentrations ranged from 1–100
\begin_inset space ~
\end_inset

L
\begin_inset Formula $^{-1}$
\end_inset

.
 
\end_layout

\begin_layout Standard
As was the case for the flight-3 case examined above, beam 2 appears to
 be more noisy than the other beams, and there are some cases where beam
 1 (looking downward) appears to be affected by returns from the ground.
 Because the measurement of airspeed is over-constrained in the case of
 valid measurements from four beams, it is possible to use a chisquare test
 of consistency among the four beams as a test of validity of the solution.
 The chisquare for the solution was developed in the LAMSprocessing4Bwind.pdf
 memo:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\chi^{2}=\sum_{i}\frac{(a_{i}^{\prime}-a_{i})^{2}}{\sigma^{2}}\label{eq:chisquare}
\end{equation}

\end_inset

where 
\begin_inset Formula $a_{i}^{\prime}$
\end_inset

 are the line-of-sight airspeeds measured in the four beams and 
\begin_inset Formula $a_{i}$
\end_inset

 are the corresponding airspeeds determined using the direction-cosine matrix
 for the four beams and the best-fit result for the vector wind.
 For the four-beam case, the solution for the vector wind is 
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{v}=\mathbf{Ma^{\prime}}\label{eq:4beamsoln}
\end{equation}

\end_inset

and
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{a}=\mathbf{Sv}\label{eq:DCMeq}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{M}$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}$
\end_inset

 are given by Eqs.
\begin_inset space ~
\end_inset

9 and 2 from that earlier memo.
 The solution to (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:chisquare"

\end_inset

) is then given by
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{equation}
\chi^{2}=\frac{1}{\sigma^{2}}\sum_{i}(a_{i}^{\prime}-S_{ij}v_{j})^{2}\label{eq:chi-2}
\end{equation}

\end_inset

Code to calculate this value, using 
\begin_inset Formula $\sigma$
\end_inset

=1, is included in the 
\begin_inset Quotes eld
\end_inset

ProcessWind()
\begin_inset Quotes erd
\end_inset

 function in this code.
 For the region from flight 3 shown in Fig.
\begin_inset space ~
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:LAMST-1}
\end_layout

\end_inset

, the mean value was 0.16
\begin_inset space ~
\end_inset

m
\begin_inset Formula $^{2}$
\end_inset

s
\begin_inset Formula $^{-2}$
\end_inset

, so these 4-beam measurements were reasonably consistent, but there were
 five outliers with values exceeding 1
\begin_inset space ~
\end_inset

m
\begin_inset Formula $^{2}$
\end_inset

s
\begin_inset Formula $^{-2}$
\end_inset

 that should be excluded as being inconsistent among the four beams.
 The value of 
\begin_inset Formula $\chi^{2}$
\end_inset

 can thus be used to identify regions where the 4-beam solution is questionable,
 and a requirement that it be smaller than about 0.5
\begin_inset space ~
\end_inset

m
\begin_inset Formula $^{2}$
\end_inset

s
\begin_inset Formula $^{-2}$
\end_inset

appears reasonable on the basis of values from good flight segments.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<LAMST-2, include=TRUE, fig.cap='(top) The difference between the LAMS-derived
 airspeed (TASL) and the conventional airspeed (TASX), for the period from
 17:39:00--17:46:00 from ARISTO-2015 flight 2.
 (bottom) The RMS error for the fit to the four measured line-of-sight beam
 speeds, for the same flight segment.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Flight <- "rf02_LAMS"
\end_layout

\begin_layout Plain Layout

fname = sprintf("%s%s/%s%sLAMS.nc", Directory,ProjectDir,Project,Flight)
\end_layout

\begin_layout Plain Layout

Data <- getNetCDF (fname, standardVariables(c(VarList, "CONCD_RPT", "PLWCD_RPT")
))
\end_layout

\begin_layout Plain Layout

## these points appear to be bad, beam 2:
\end_layout

\begin_layout Plain Layout

# Data$BEAM2speed[getIndex(Data, 200951)] <- NA
\end_layout

\begin_layout Plain Layout

# Data$BEAM2speed[getIndex(Data, 200948)] <- NA
\end_layout

\begin_layout Plain Layout

# Data$BEAM2speed[getIndex(Data, 200954)] <- NA
\end_layout

\begin_layout Plain Layout

PCA <- FALSE    ## use SG polynomial solution
\end_layout

\begin_layout Plain Layout

PCA <- TRUE     ## use PCA solution
\end_layout

\begin_layout Plain Layout

DW <- processWind(Data)
\end_layout

\begin_layout Plain Layout

DW$BEAM2speed <- Data$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$PSXC <- Data$PSXC
\end_layout

\begin_layout Plain Layout

DW$QCXC <- Data$QCXC
\end_layout

\begin_layout Plain Layout

DW$ATX <- Data$ATX
\end_layout

\begin_layout Plain Layout

DW$CONCD <- Data$CONCD_RPT
\end_layout

\begin_layout Plain Layout

DW$PLWCD <- Data$PLWCD_RPT
\end_layout

\begin_layout Plain Layout

DW$AKRDF <- cf4[1] + DW$ADIFR/DW$QCF * (cf4[2] + cf4[3] * MachNumber (DW$PSF,
 DW$QCF, DW$EWX))
\end_layout

\begin_layout Plain Layout

r <- setRange (DW, 173000, 192000)
\end_layout

\begin_layout Plain Layout

rt <- setRange (DW$Time, 173900, 174600)
\end_layout

\begin_layout Plain Layout

DW$QR <- DW$ADIFR / DW$QCF
\end_layout

\begin_layout Plain Layout

DW$Mach <- MachNumber (DW$PSXC, DW$QCXC, DW$EWX)
\end_layout

\begin_layout Plain Layout

DW$TASL <- DW$TASX
\end_layout

\begin_layout Plain Layout

## temporary: use beam 2 only
\end_layout

\begin_layout Plain Layout

# DW$TASL <- DW$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$TASL3 <- (Data$BEAM1speed + DW$BEAM3speed + DW$BEAM4speed) / (3 * cos
 (35*pi/180))
\end_layout

\begin_layout Plain Layout

DW$TASL1 <- Data$BEAM2speed
\end_layout

\begin_layout Plain Layout

DW$TASX <- Data$TASX
\end_layout

\begin_layout Plain Layout

# DW <- DW[r, ]
\end_layout

\begin_layout Plain Layout

CP <- SpecificHeats (DW$EWX / DW$PSXC)
\end_layout

\begin_layout Plain Layout

cpa <- CP[,1]
\end_layout

\begin_layout Plain Layout

Ra <- CP[,3]
\end_layout

\begin_layout Plain Layout

cva <- CP[,2]
\end_layout

\begin_layout Plain Layout

gamma <- cpa/cva
\end_layout

\begin_layout Plain Layout

DTAS <- with(DW[rt, ], mean (TASX-TASL, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

DTAS3 <- with (DW[rt, ], mean (TASX-TASL3, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

DTAS1 <- with (DW[rt, ], mean (TASX-TASL1, na.rm=TRUE))
\end_layout

\begin_layout Plain Layout

Vs <- (DW$TASL + DTAS) / DW$Mach
\end_layout

\begin_layout Plain Layout

Vs3 <- (DW$TASL3 + DTAS3) / DW$Mach
\end_layout

\begin_layout Plain Layout

Vs1 <- (DW$TASL1 + DTAS1) / DW$Mach
\end_layout

\begin_layout Plain Layout

TL <- Vs^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

TL3 <- Vs3^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

TL1 <- Vs1^2 / (gamma * Ra) - 273.15
\end_layout

\begin_layout Plain Layout

LS <- 13
\end_layout

\begin_layout Plain Layout

TLS <- SmoothInterp (TL, .Length=LS)
\end_layout

\begin_layout Plain Layout

TLS1 <- SmoothInterp (TL1, .Length=LS)
\end_layout

\begin_layout Plain Layout

TLS3 <- SmoothInterp (TL3, .Length=LS)
\end_layout

\begin_layout Plain Layout

# TL <- DW$TASL^2 / (2*cpa * (((DW$PSXC+DW$QCXC)/DW$PSXC)^(Ra/cpa) - 1))
 - 273.15
\end_layout

\begin_layout Plain Layout

layout(matrix(1:2, ncol = 1), widths = 1,  heights = c(5,6))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(2,4,1,1)+0.1, oma=c(1.1,0,0,0))
\end_layout

\begin_layout Plain Layout

ATX <- DW$ATX
\end_layout

\begin_layout Plain Layout

# plotWAC(data.frame(DW$Time, ATX, TLS), ylab='Temperature [C]', 
\end_layout

\begin_layout Plain Layout

#         ylim=c(5,17), lwd=c(2,2), lty=c(1,2), legend.position='topright')
\end_layout

\begin_layout Plain Layout

# Excl <- DW$CONC < 5
\end_layout

\begin_layout Plain Layout

# ATX[Excl] <- NA
\end_layout

\begin_layout Plain Layout

# TLS[Excl] <- NA
\end_layout

\begin_layout Plain Layout

# lines (DW$Time+0.5, ATX, lwd=4, col='cyan')
\end_layout

\begin_layout Plain Layout

# lines (DW$Time+0.5, TLS, lwd=4, col='darkgreen')
\end_layout

\begin_layout Plain Layout

# points (DW$Time, TL, pch=20, col='magenta')
\end_layout

\begin_layout Plain Layout

# op <- par (mar=c(5,4,1,1)+0.1)
\end_layout

\begin_layout Plain Layout

# plotWAC(subset(DW,, c(Time, CONCD)))
\end_layout

\begin_layout Plain Layout

DW$RMS <- sqrt (DW$TASCSQ / 4)
\end_layout

\begin_layout Plain Layout

plotWAC (data.frame (DW$Time, DW$TASL-DW$TASX)[rt, ], ylab='TASL-TASX', ylim=c(-1
,1))
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(5,4,1,1)+0.1)
\end_layout

\begin_layout Plain Layout

with (DW[rt, ], plotWAC (Time, RMS, ylim=c(0,0.5), ylab='RMS [m/s]'))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<LAMST-3, include=TRUE, fig.cap='For the same flight period shown in the
 previous figure, the temperature deduced from the measurement obtained
 using the LAMS-measured airspeed (dark green line), adjusted as described
 in the text, plotted with the standard measurement of temperature (ATX).
 The measurements from periods where the CDP concentration exceeded 5
\backslash

\backslash
_cm$^{-3}$ are shown as thicker lines plotted, in the case of ATX, in a
 different color.'>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

DW$TLS <-TLS
\end_layout

\begin_layout Plain Layout

DW <- DW[rt, ]
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(2,4,1,1)+0.1, oma=c(1.1,0,0,0))
\end_layout

\begin_layout Plain Layout

plotWAC(data.frame(DW$Time, DW$ATX, DW$TLS), ylab='Temperature [C]', 
\end_layout

\begin_layout Plain Layout

        ylim=c(5,17), lwd=c(2,2), lty=c(1,2), legend.position='topright')
\end_layout

\begin_layout Plain Layout

Excl <- DW$CONC < 5
\end_layout

\begin_layout Plain Layout

DW$ATX[Excl] <- NA
\end_layout

\begin_layout Plain Layout

DW$TLS[Excl] <- NA
\end_layout

\begin_layout Plain Layout

lines (DW$Time+0.5, DW$ATX, lwd=4, col='cyan')
\end_layout

\begin_layout Plain Layout

lines (DW$Time+0.5, DW$TLS, lwd=4, col='darkgreen')
\end_layout

\begin_layout Plain Layout

# points (DW$Time, TL, pch=20, col='magenta')
\end_layout

\begin_layout Plain Layout

op <- par (mar=c(5,4,1,1)+0.1)
\end_layout

\begin_layout Plain Layout

plotWAC(subset(DW,, c(Time, CONCD)))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig:LAMST-2}
\end_layout

\end_inset

 shows a segment from this flight for which the measurements appear consistent
 among the four beams, especially for the last 2-min period.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
clearpage
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center

\family sans
\color blue
– End of Memo –
\end_layout

\begin_layout Standard
Reproducibility:
\begin_inset Note Note
status open

\begin_layout Plain Layout
include enough info to re-run.
 in zip, include program, pdf if not too big, and subset data, not entire
 file.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Project:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{thisFileName}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Archive package:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{thisFileName}.zip
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Contains:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
attachment list below
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Program:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{thisFileName}.Rnw
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Original Data:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash
 %/scr/raf
\backslash
_data/
\backslash
Sexpr{Project}/
\backslash
Sexpr{Project}
\backslash
Sexpr{Flight}.nc
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Workflow:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Workflow
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{thisFileName}.pdf
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
\shape smallcaps
\color blue
Git:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

https://github.com/WilliamCooper/
\backslash
Sexpr{thisFileName}.git
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
attachm{
\backslash
Sexpr{thisFileName}.Rnw
\backslash

\backslash

\backslash
Sexpr{thisFileName}.pdf
\backslash

\backslash

\backslash
Sexpr{SaveRData}
\backslash

\backslash
SessionInfo}
\end_layout

\begin_layout Plain Layout

%
\backslash
cc{first attachment
\backslash

\backslash
second
\backslash

\backslash
3rd att}
\end_layout

\begin_layout Plain Layout

%
\backslash
attach{attachment}
\end_layout

\begin_layout Plain Layout

%
\backslash
attachm{first
\backslash

\backslash
second} %
\backslash
cc{first attachment
\backslash

\backslash
second
\backslash

\backslash
3rd att}
\end_layout

\begin_layout Plain Layout

<<save-system-info, echo=FALSE>>= 
\end_layout

\begin_layout Plain Layout

cat (toLatex(sessionInfo()), file="SessionInfo")
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\begin_layout Plain Layout

<<make-zip-archive, echo=TRUE, INCLUDE=TRUE>>=
\end_layout

\begin_layout Plain Layout

system (sprintf("zip %s.zip %s.Rnw %s.pdf Workflow%s.pdf SessionInfo %s", thisFileNa
me, thisFileName, thisFileName, thisFileName, SaveRData))
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% 
\backslash
attach{attachment}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% 
\backslash
attachm{ProgramFile
\backslash

\backslash
Document.pdf
\backslash

\backslash
SaveRData}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
cc{first attachment
\backslash

\backslash
second
\backslash

\backslash
3rd att}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
